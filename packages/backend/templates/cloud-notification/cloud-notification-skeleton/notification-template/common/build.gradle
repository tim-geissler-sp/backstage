jacocoTestCoverageVerification {
	violationRules {
		rule {
			limit {
				counter = 'COMPLEXITY'
				minimum = 0.82
			}
		}
	}
}

dependencies {
	api(platform("com.sailpoint:atlas-platform:$project.ATLAS_VERSION"))

	compile(project(":notification-common"))
	compile("org.apache.velocity:velocity-engine-core")
	compile("com.github.wnameless:json-flattener")
	compile("com.sailpoint:atlas-dynamodb")
	compile("com.googlecode.owasp-java-html-sanitizer:owasp-java-html-sanitizer:20200713.1")

	implementation("com.fasterxml.jackson.datatype:jackson-datatype-joda")

	testCompile("com.sailpoint:atlas-test")
}

task copyNativeDeps(type: Copy) {
	from(configurations.compile + configurations.testCompile) {
		include '*.dll'
		include '*.dylib'
		include '*.so'
	}
	into 'build/libs'
}

test {
	dependsOn copyNativeDeps
	systemProperty "java.library.path", 'build/libs'
}
